<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>clockchart-construction • clockplot</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="clockchart-construction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clockplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/clockplot.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/clockchart-construction.html">clockchart-construction</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>clockchart-construction</h1>
            
      

      <div class="d-none name"><code>clockchart-construction.Rmd</code></div>
    </div>

    
    
<p><span style="color:Orange;">⚠</span> This vignette is still
developing. Read with caution.</p>
<p>This document reveals what’s going on behind the scene–how the charts
are constructed–how the idea was conceived and implemented after
numerous trial and error. For the details on how to use the package, see
<a href="clockplot.html">clockplot</a>.</p>
<p><span style="color:Orange;">⚠</span> The plots shown here may not
produce the expected output due to the behavior of Rmarkdown. To see the
actual appearance, run the codes given.</p>
<p>Broadly speaking, the construction of the clockcharts have two
steps.</p>
<ol style="list-style-type: lower-roman">
<li>Construction of the 24-hour clock</li>
<li>Plotting event times on the clock</li>
</ol>
<p>Each steps has two substeps:</p>
<ol style="list-style-type: lower-alpha">
<li>The mathematical idea</li>
<li>The programming</li>
</ol>
<div class="section level3">
<h3 id="the-clock-skeleton">The Clock Skeleton<a class="anchor" aria-label="anchor" href="#the-clock-skeleton"></a>
</h3>
<p>First we need to construct the skeleton, the clock on which event
times are plotted. For this, we need a circle, on which we have to mark
24 dots to denote 24 hours, starting from 00:00 (12 AM) to 23:00 (11
PM).</p>
<p>It is enough to draw a unit circle, although a circle of any radius
would do. In <code>R</code>, it is easiest to draw a circle using the
complex equation. For a unit circle, the equation is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>e</mi><mrow><mi>i</mi><mi>θ</mi></mrow></msup><annotation encoding="application/x-tex">e^{i\theta}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>e</mi><annotation encoding="application/x-tex">e</annotation></semantics></math>
is Euler’s number, an irrational constant having the approximate value
of 2.71828;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
stands for imaginary unit, equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><mrow><mo>−</mo><mn>1</mn></mrow></msqrt><annotation encoding="application/x-tex">\sqrt{-1}</annotation></semantics></math>;
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
refers to the trigonometric angle in radian. To make a complete circle,
we need to allow
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
to take values from 0 to 360 degrees
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding="application/x-tex">2\pi</annotation></semantics></math>
in radian).</p>
<p>Programmatically, we need to create some angles ranging from 0 to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding="application/x-tex">2\pi</annotation></semantics></math>
and then connect them to make a complete circle. Let us create 100
angles and use them in the circle equation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>e</mi><mrow><mi>i</mi><mi>θ</mi></mrow></msup><annotation encoding="application/x-tex">e^{i\theta}</annotation></semantics></math>).
The trigonometric form of the equation is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><msup><mi>n</mi><mn>2</mn></msup><mi>θ</mi><mo>+</mo><mi>c</mi><mi>o</mi><msup><mi>s</mi><mn>2</mn></msup><mi>θ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">sin^2 \theta + cos^2 \theta = 1</annotation></semantics></math>,
while the algebraic form is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x^2+y^2 = 1</annotation></semantics></math>.
The complex form, however, is more convenient.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">timepoint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1i</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="op">(</span><span class="va">k</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="va">k</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">timepoint</span>, pch <span class="op">=</span> <span class="fl">19</span>, type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="clockchart-construction_files/figure-html/unnamed-chunk-2-1.png" alt="The Unit Circle" width="384"><p class="caption">
The Unit Circle
</p>
</div>
<p>Here <code>R</code> just takes the complex numbers and plots the
values of the real part on the X axis and the corresponding values of
the imaginary part on the Y axis.</p>
<p>Now we have to mark the hours on the circle to make it look like a
clock. We have to show 24 hours marks as well some marks for minute
marks, corresponding to the fraction of the hour. This clock is slightly
different from a traditional clock not only in that it has 24 hours
instead of 12, but also that it has only one hand, the hour hand, with
minute part added to the hour mark as the fraction; the second part,
having minor contribution, is ignored.</p>
<p>First, let us see the output with 24 hour marks.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">24</span></span>
<span><span class="va">hour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1i</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="op">(</span><span class="va">k</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="va">k</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hour</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<p><img src="clockchart-construction_files/figure-html/circle-1.png" width="384" style="display: block; margin: auto;"></p>
<p>At this time, we move to the <code>R</code> package
<code>ggplot2</code> to produce better graphics. We need to create an
<code>R</code> data frame for plotting ggplots. We also mark some points
for minutes.</p>
<p>First, let us create the required data frame</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">24</span> <span class="co"># Hours</span></span>
<span><span class="va">subk</span> <span class="op">&lt;-</span> <span class="fl">24</span><span class="op">*</span><span class="fl">4</span> <span class="co"># Fraction of hours</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1i</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="op">(</span><span class="va">k</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="va">k</span><span class="op">)</span></span>
<span><span class="va">subtimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>SubT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1i</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="op">(</span><span class="va">subk</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="va">subk</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">ampm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">" AM"</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">" PM"</span>,<span class="fl">12</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">" AM"</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="va">dfclock</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">times</span>,</span>
<span>                  hour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="co"># May not be needed</span></span>
<span>                  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="va">ampm</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Explanation</strong></p>
<p><code>k = 24</code> indicates there are 24 hours. Then in each hour
is divided into 4 parts , corresponding to the elapse of successive 15
minutes. Thus, a small point on @ref(fig:clock24) in the middle of two
larger point (hour) means half an hour has elapsed. For instance, the
the point in the middle of 7 PM and 8 PM is 7:30 PM.</p>
<p>Now the code <code>exp(1i * 2 * pi * (k:1) / k)</code> gives us all
the angles corresponding to 24 hours on the clock. Here, we have to note
that the angles in trigonometry starts from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>0</mn><mi>o</mi></msup><annotation encoding="application/x-tex">0^o</annotation></semantics></math>
(X-axis) and rotates counter-clockwise, the direction opposite to the
rotation of clock hands (the significance of the difference will be seen
shortly). But the clock moves clockwise. At 0 degree, we have 3 in a
12-hour clock and 6 in 24-hours clock.</p>
<p>Similarly, the code
<code>SubT = exp(1i * 2 * pi * (subk:1) / subk)</code> gives us the
angles corresponding to the fraction of an hour. As we have already
mentioned, the clock hand rotates clock-wise, starting from the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>0</mn><mi>o</mi></msup><annotation encoding="application/x-tex">0^o</annotation></semantics></math>
angle, so we name the labels 6 PM to 11 PM, then we have 12 PM to 11 PM,
followed by 12 AM to 5 AM.</p>
<p>The code <code>c(rep(" AM",6), rep(" PM",12), rep(" AM",6))</code>
ensures this sequence.</p>
<p>We then place the data into two data frames <code>subtimes</code> and
<code>dfclock</code>, since they are unequal dimensions.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># Load the package ggplot2</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">dfclock</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">subtimes</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Re</a></span><span class="op">(</span><span class="va">SubT</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Im</a></span><span class="op">(</span><span class="va">SubT</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Connect Last two missing points</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">subtimes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">95</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Re</a></span><span class="op">(</span><span class="va">SubT</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Im</a></span><span class="op">(</span><span class="va">SubT</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dfclock</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Re</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">*</span><span class="fl">1.1</span>, <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Im</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">*</span><span class="fl">1.1</span>, label <span class="op">=</span> <span class="va">label</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">subtimes</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Re</a></span><span class="op">(</span><span class="va">SubT</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Im</a></span><span class="op">(</span><span class="va">SubT</span><span class="op">)</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">19</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Re</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Im</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">1.8</span><span class="op">)</span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="clockchart-construction_files/figure-html/skeleton-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Next, we plot the lines using the <code>ggplot2</code> package. The
functions <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path()</a></code> does the job, while
<code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code> is used to fill the gap between the first and
the last point. <code>aspect.ratio = 1</code> is set to ensure the chart
size do not depend on resizing of <code>Rstudio</code> Viewer size.</p>
<p>The points corresponding to the hours are labelled AM or PM using the
<code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text()</a></code> function. We do not need the axis labels and
ticks. Let us remove them:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        axis.ticks.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        axis.text.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,  </span>
<span>        axis.ticks.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="clockchart-construction_files/figure-html/skeleton_clean-1.png" width="384" style="display: block; margin: auto;"></p>
<p>This completes our first part of the plot; we get the skeleton of the
clock.</p>
<p>The second and final part of the task involves plotting event times
on the appropriate points. Now, this task has several variations. In the
simplest form, we just have a chart, so called <code>clock_chart</code>,
which plots the event times on the 24-hour clock. An optional argument
<code>Col</code> can be used to change the color of the clock hands. The
other variations will be discussed later, when we complete the
discussion on how the event times are prepared for plotting.</p>
<div class="section level4">
<h4 id="preparation-of-event-times-data">Preparation of Event Times Data<a class="anchor" aria-label="anchor" href="#preparation-of-event-times-data"></a>
</h4>
<p>We have data in the format <code>HH:MM:SS</code>. We need to convert
this data to <code>(x,y)</code> coordinates. In the unit circle, for
example, the 12 AM should be plotted on the Y-axis (x = 0, y = 1) and 6
AM on the X axis (x = 1, y = 0), although, to avoid plotting on the
circumference, we decrease the length a little (more on this later).</p>
<p>To convert the <code>HH:MM:SS</code> to coordinates of the unit
circle, we first separate the parts of time into <code>HH</code>,
<code>MM</code>, and <code>SS</code>. We accomplish that using the
<code>dplyr</code> and <code>tidyr</code> package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data to check on</span></span>
<span><span class="va">chkdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"06:00:00"</span>, <span class="st">"12:00:00"</span>, <span class="st">"17:30:00"</span>, <span class="st">"00:05:25"</span><span class="op">)</span>,</span>
<span>                    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="va">chkdf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html" class="external-link">separate_wider_delim</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">time</span>, </span>
<span>                         names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hour"</span>, <span class="st">"minute"</span>, <span class="st">"second"</span><span class="op">)</span>, </span>
<span>                         cols_remove <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                         delim <span class="op">=</span> <span class="st">":"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">#&gt;   hour  minute second time     value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 06    00     00     06:00:00     7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 12    00     00     12:00:00     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 17    30     00     17:30:00     6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 00    05     25     00:05:25    10</span></span></code></pre></div>
<p>This gives us <code>hour</code>, <code>minute</code>, and
<code>second</code> as character (<code>chr</code>) vectors, but we need
them as numeric vectors. The conversion is made with
<code>as.numeric</code> function.</p>
<p>Here the challenge now is to combine the hour and the minute into one
singe time, which we would later convert to coordinate. We intentionally
ignore the second (<code>SS</code>), since it has too negligible
contribution on the plot.</p>
<p>Here a short algorithm is to be used:</p>
<p>Note here that 30 minutes is equivalent to half an hour, so
<code>1:30:00</code> corresponds to 1.5 hour. We need to recall that
time values range from 0 to 60, while our decimal number system gives us
the suitable range 1 to 100. In our number system, reaching 100
indicates we have completed some work, while clockworks say reaching 60
completes one cycle of the task.</p>
<p>The hour part does not need conversion. 23 is 23 and 22 is 22.</p>
<p>Thus, 15 minutes on the clock says
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>15</mn><mn>60</mn></mfrac><mo>=</mo><mfrac><mn>1</mn><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{15}{60} = \frac14</annotation></semantics></math>
th or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>25</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">25\%</annotation></semantics></math>
work, 30 means
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>30</mn><mn>60</mn></mfrac><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\frac{30}{60} = \frac12 = 0.5</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>50</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">50\%</annotation></semantics></math>
work, and 50 means
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>50</mn><mn>60</mn></mfrac><annotation encoding="application/x-tex">\frac{50}{60}</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>83</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">83\%</annotation></semantics></math>
work have been completed.</p>
<p>The task is further complicated due to the clock and angles rotating
in opposite directions.</p>
<p>////THIS CONVERSION IS A BUG////
ifelse(.data<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>u</mi><mi>t</mi><mi>e</mi><mo>&lt;</mo><mn>10</mn><mo>,</mo><mi>.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">minute&lt;10, .data</annotation></semantics></math>minute
* 5/30, .data$minute * 5/300) ////MAY DEPEND ON OLD TIME FORMAT HHMM
hrs/////</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Abdullah Al Mahmud.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
